{% extends "base.html" %}

{% block title %}Home - ServiceHub{% endblock %}

{% block content %}
<section class="hero py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-7">
                <h1 class="display-5 fw-bold">
                    {% if session.get('role') == 'client' %}
                    Welcome to Your Service Dashboard
                    {% else %}
                    Reliable services, just a few clicks away
                    {% endif %}
                </h1>
                <p class="lead text-muted mb-4">
                    {% if session.get('role') == 'client' %}
                    Manage your {{ session.get('service_type') }} service requests efficiently and professionally.
                    {% else %}
                    Book trusted professionals for plumbing, electrical, cleaning and more. Fast responses for emergencies.
                    {% endif %}
                </p>
                {% if session.get('role') == 'client' %}
                <a href="{{ url_for('client_dashboard') }}" class="btn btn-primary btn-lg me-2">
                    <i class="bi bi-speedometer2 me-1"></i>Go to Dashboard
                </a>
                <a href="{{ url_for('client_requests') }}" class="btn btn-outline-primary btn-lg">
                    <i class="bi bi-inbox me-1"></i>View Requests
                </a>
                {% else %}
                <a href="#services" class="btn btn-primary btn-lg me-2">Explore Services</a>
                <a href="{{ url_for('service_form', service_id=1) }}" class="btn btn-outline-primary btn-lg">Request Service</a>
                {% endif %}
            </div>
            <div class="col-md-5 d-none d-md-block">
                <img src="https://via.placeholder.com/420x300" alt="service illustration" class="img-fluid rounded shadow">
            </div>
        </div>
    </div>
</section>

<section id="services" class="py-5">
    <div class="container">
        <div class="row mb-4">
            <div class="col-md-8">
                <h2 class="h3">
                    {% if session.get('role') == 'client' %}
                    Your Service: {{ session.get('service_type') }}
                    {% else %}
                    Our Services
                    {% endif %}
                </h2>
                <p class="text-muted">
                    {% if session.get('role') == 'client' %}
                    This is your dedicated service page. Customers can book {{ session.get('service_type') }} services directly here.
                    {% else %}
                    Choose from our curated selection of services below.
                    {% endif %}
                </p>
            </div>
        </div>

        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4">
            {% for service in services %}
            <div class="col">
                <div class="card h-100 service-card">
                    <div class="card-body text-center">
                        {% if service.name == 'Plumbing' %}
                            <i class="bi bi-droplet-fill service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Electrical' %}
                            <i class="bi bi-lightning-fill service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Carpentry' %}
                            <i class="bi bi-hammer service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Cleaning' %}
                            <i class="bi bi-brush service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Gardening' %}
                            <i class="bi bi-flower1 service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Automotive' %}
                            <i class="bi bi-car-front-fill service-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Ambulance' %}
                            <i class="bi bi-hospital-fill service-icon emergency-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Police' %}
                            <i class="bi bi-shield-fill-check service-icon emergency-icon" aria-hidden="true"></i>
                        {% elif service.name == 'Fire Fighter' %}
                            <i class="bi bi-fire service-icon emergency-icon" aria-hidden="true"></i>
                        {% endif %}
                        <h5 class="card-title">{{ service.name }}</h5>
                        <p class="card-text">{{ service.description }}</p>
                        {% if session.get('role') == 'client' %}
                            {% if service.name == session.get('service_type') %}
                                {% if service.name in ['Ambulance', 'Police', 'Fire Fighter'] %}
                                    <div class="alert alert-danger" role="alert">
                                        <i class="bi bi-exclamation-triangle me-2"></i>
                                        <strong>Emergency Service Active</strong><br>
                                        <small>You are registered as an emergency service provider.</small>
                                    </div>
                                {% else %}
                                    <div class="alert alert-success" role="alert">
                                        <i class="bi bi-check-circle me-2"></i>
                                        <strong>Your Registered Service</strong><br>
                                        <small>Customers can book this service directly.</small>
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% else %}
                            {% if session.get('username') %}
                                {% if service.name in ['Ambulance', 'Police', 'Fire Fighter'] %}
                                    <a href="{{ url_for('service_form', service_id=service.id) }}" class="btn btn-danger w-100" aria-label="Request Emergency {{ service.name }}">
                                        <i class="bi bi-telephone-fill me-2" aria-hidden="true"></i>Request Emergency
                                    </a>
                                {% else %}
                                    <a href="{{ url_for('service_form', service_id=service.id) }}" class="btn btn-primary w-100" aria-label="Book {{ service.name }}">
                                        <i class="bi bi-calendar-check me-2" aria-hidden="true"></i>Book Service
                                    </a>
                                {% endif %}
                            {% else %}
                                <a href="{{ url_for('login', next=url_for('service_form', service_id=service.id)) }}" class="btn btn-outline-primary w-100" aria-label="Sign in to book {{ service.name }}">
                                    <i class="bi bi-box-arrow-in-right me-2" aria-hidden="true"></i>Sign in to Book
                                </a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
            
            {% if session.get('role') == 'client' and services|length == 0 %}
            <div class="col-12">
                <div class="card">
                    <div class="card-body text-center py-5">
                        <i class="bi bi-tools display-1 text-muted mb-3"></i>
                        <h4 class="text-muted">No Service Associated</h4>
                        <p class="text-muted">Your account is not associated with any service type. Please contact support.</p>
                        <a href="{{ url_for('logout') }}" class="btn btn-primary">Logout</a>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>

        {% if session.get('role') == 'client' %}
        <div class="row mt-5">
            <div class="col-12">
                <div class="card bg-light">
                    <div class="card-body text-center">
                        <h4 class="mb-3">Service Provider Tools</h4>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <a href="{{ url_for('client_dashboard') }}" class="btn btn-primary w-100 py-3">
                                    <i class="bi bi-speedometer2 display-6 d-block mb-2"></i>
                                    Dashboard
                                    <small class="d-block text-light opacity-75">Overview & Analytics</small>
                                </a>
                            </div>
                            <div class="col-md-4 mb-3">
                                <a href="{{ url_for('client_requests') }}" class="btn btn-success w-100 py-3">
                                    <i class="bi bi-inbox display-6 d-block mb-2"></i>
                                    All Requests
                                    <small class="d-block text-light opacity-75">Manage Service Requests</small>
                                </a>
                            </div>
                            <div class="col-md-4 mb-3">
                                <a href="#" class="btn btn-info w-100 py-3">
                                    <i class="bi bi-person display-6 d-block mb-2"></i>
                                    Profile
                                    <small class="d-block text-light opacity-75">Update Information</small>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}